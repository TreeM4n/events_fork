# Continued events for Surveyor
namespace = mem_ceaseless
# Origin event setup wormhole system
country_event = {
	id = mem_ceaseless.1
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		has_origin = origin_mem_ceaseless_gaze
	}
	immediate = {
		capital_scope = {
			solar_system = {
				spawn_system = {
					initializer = mem_mirror_hall_system
					hyperlane = no
				}
			}
			last_created_system = {
				add_hyperlane = {
					from = THIS
					to = root.capital_scope.solar_system
				}
			}
			change_planet_size = 21			# mod compatibility thing
		}
		give_technology = {
			tech = tech_wormhole_stabilization
			message = no
		}
		while = {
			count = 4
			random_system = {
				limit = {
					NOR = {
						has_star_flag = empire_home_system
						has_star_flag = empire_cluster
						exists = owner
					}
				}
				set_star_flag = mem_ceaseless_wormhole_target
				spawn_megastructure = {
					type = mem_ceaseless_base
					orbit_distance = 200
					# orbit_angle = {
					# 	min = 0
					# 	max = 360
					# }
				}
			}
		}
	}
}

# check for mem_ceaseless_colonizer ship
planet_event = {
	id = mem_ceaseless.3
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		owner = {
			has_origin = origin_mem_ceaseless_gaze
		}
		has_planet_flag = mem_ceaseless_colonizer_start
		# NOR = {
		# 	is_same_value = owner.capital_scope
		# 	exists = sector
		# }
	}
	immediate = {
		owner = {
			save_event_target_as = future_overlrod
			capital_scope = {
				if = {
					limit = {
						num_pops > 10
					}
					while = {
						count = 5
						random_owned_pop = {
							resettle_pop = {
								pop = THIS
								planet = root
							}
						}
					}
				}
			}
		}
		add_district = district_city
		if = {
			limit = {
				any_system = {
					exists = owner
					owner = {
						has_origin = origin_mem_ceaseless_gaze_vassal
					}
					event_target:future_overlrod = {
						has_subject = prevprev.owner
					}
					distance = {
						source = root
						max_jumps = 10
						type = hyperlane
					}
				}
			}
			random_system = {
				limit = {
					exists = owner
					owner = {
						has_origin = origin_mem_ceaseless_gaze_vassal
					}
					event_target:future_overlrod = {
						has_subject = prevprev.owner
					}
					distance = {
						source = root
						max_jumps = 10
						type = hyperlane
					}
				}
				owner = {
					save_event_target_as = mem_ceaseless_give_vassal
				}
			}
		}
		### create new vassal
		else = {
			create_country = {
				name = RANDOM
				civics = RANDOM
				species = event_target:future_overlrod.owner_main_species
				effect = {
					set_origin = origin_mem_ceaseless_gaze_vassal
					save_event_target_as = mem_ceaseless_give_vassal
					#copy_ethos_and_authority = root.owner 
					copy_techs_from = {
						target = event_target:future_overlrod
					}
				}
				ignore_initial_colony_error = yes
			}
			last_created_country = {
				if = {
					limit = {
						has_civic = civic_fanatic_purifiers
					}
					force_remove_civic = civic_fanatic_purifiers
				}
				establish_communications_no_message = event_target:future_overlrod
				if = {
					limit = {
						host_has_dlc = "Overlord"
					}
					set_subject_of = {
						who = event_target:future_overlrod.owner
						allow_instant_negotiation = yes
						preset = preset_specialist_mem_frontier_sector
					}
				}
				else = {
					set_subject_of = {
						who = event_target:future_overlrod.owner
						allow_instant_negotiation = yes
						preset = preset_release_sector
					}
				}
				#establish_communications_no_message = root.owner
				add_resource = {
					minerals = 2000
					energy = 5000
					influence = 200
					alloys = 500
					consumer_goods = 500
					food = 1000
				}
				save_event_target_as = future_subject
				
			}
			event_target:future_overlrod = {
				add_intel = {
					who = event_target:future_subject
					amount = 100
				}
			}
		}
		starbase = {
			set_owner = event_target:mem_ceaseless_give_vassal
		}
		#add_colony_progress = 100
		set_owner = event_target:mem_ceaseless_give_vassal
		remove_planet_flag = mem_ceaseless_colonizer_start
	}
}

# check for mem_ceaseless_colonizer ship
planet_event = {
	id = mem_ceaseless.4
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		exists = FROM
		FROM = {
			is_ship_size = mem_ceaseless_colonizer
		}
		#is_artificial = no
	}
	immediate = {
		set_planet_flag = mem_ceaseless_colonizer_start
	}
}

country_event = {
	id = mem_ceaseless.999
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		has_origin = origin_mem_ceaseless_gaze
	}
	immediate = {
		random_system = {
			limit = {
				NOT = {
					exists = owner
				}
				any_system_planet = {
					is_colonizable = yes
				}
			}
			create_starbase = {
				size = starbase_outpost
			}
			random_system_planet = {
				limit = {
					is_colonizable = yes
				}
				set_planet_flag = mem_ceaseless_colonizer_start
				create_colony = {
					owner = root
				}
				planet_event = {
					id = mem_ceaseless.3
				}
			}
		}
	}
}

# on enter system, %chance for probe to died here
ship_event = {
	id = mem_ceaseless.5
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		exists = owner
		owner = {
			has_origin = origin_mem_ceaseless_gaze
		}
	}
	immediate = {
		random_list = {
			10 = {
				if = {
					limit = {
						owner = {
							has_event_chain = mem_ceaseless_lost_probes
						}
					}
					system_star = {
						root.owner = {
							enable_special_project = {
								name = MEM_CEASELESS_PROBE_SIGNATURE_PROJECT
								location = prev
							}
						}
					}
					owner = {
						create_message = {
							type = MESSAGE_MEM_CEASELESS_FOUND_PROBE_SIGNATURE
							target = root.solar_system
							days = 30
						}
					}
				}
				else = {
					ship_event = {
						id = mem_ceaseless.6
					}
				}
			}
			90 = {
			}
		}
	}
}

# first time we found probe
ship_event = {
	id = mem_ceaseless.6
	title = mem_ceaseless.6.title
	desc = mem_ceaseless.6.desc
	picture = GFX_evt_ship_travel
	location = this
	show_sound = event_bad_omen
	is_triggered_only = yes
	trigger = {
		exists = owner
		owner = {
			has_origin = origin_mem_ceaseless_gaze
		}
	}
	immediate = {
	}
	option = {
		name = mem_ceaseless.6.a
		owner = {
			begin_event_chain = {
				event_chain = mem_ceaseless_lost_probes
			}
		}
		system_star = {
			root.owner = {
				enable_special_project = {
					name = MEM_CEASELESS_PROBE_SIGNATURE_PROJECT
					location = prev
				}
			}
		}
	}
}

#################################### all random events
# - evolving probe
ship_event = {
	id = mem_ceaseless.185
	title = mem_ceaseless.185.title
	desc = mem_ceaseless.185.desc
	picture = GFX_evt_intelligence_report
	location = this
	show_sound = event_bad_omen
	is_triggered_only = yes
	trigger = {
	}
	immediate = {
	}
	option = {
		name = mem_ceaseless.185.a		#  fasc
		owner = {
			add_monthly_resource_mult = {
				value = 3
				resource = society_research
			}
		}
	}
	after = {
		mem_ceaseless_open_portals = yes
	}
}

# - “Was I ever yours to begin with?”
ship_event = {
	id = mem_ceaseless.180
	title = mem_ceaseless.180.title
	desc = mem_ceaseless.180.desc
	picture = GFX_evt_intelligence_report
	location = this
	show_sound = event_bad_omen
	is_triggered_only = yes
	trigger = {
	}
	immediate = {
	}
	option = {
		name = mem_ceaseless.180.a		#  on purpose no allow trigger
		owner = {
			add_resource = {
				influence = -100
			}
		}
	}
	after = {
		mem_ceaseless_open_portals = yes
	}
}

# - swalloed by black hole but still sending stuff 
ship_event = {
	id = mem_ceaseless.175
	title = mem_ceaseless.175.title
	desc = mem_ceaseless.175.desc
	picture = GFX_evt_black_hole
	location = this
	show_sound = event_bad_omen
	is_triggered_only = yes
	trigger = {
	}
	immediate = {
	}
	option = {
		name = mem_ceaseless.175.a		# fasc
		system_star = {
			add_deposit = d_physics_10
		}
	}
	after = {
		mem_ceaseless_open_portals = yes
	}
}

# - bladerunner tannenhäuser reference
ship_event = {
	id = mem_ceaseless.170
	title = mem_ceaseless.170.title
	desc = mem_ceaseless.170.desc
	picture = GFX_evt_cosmic_storms_shroud_storm
	location = this
	show_sound = event_bad_omen
	is_triggered_only = yes
	trigger = {
	}
	immediate = {
	}
	option = {
		name = mem_ceaseless.170.a		# fasc
		owner = {
			add_monthly_resource_mult = {
				resource = society_research
				value = 6
			}
		}
	}
	after = {
		mem_ceaseless_open_portals = yes
	}
}

# - waited until batteires ran out
ship_event = {
	id = mem_ceaseless.165
	title = mem_ceaseless.165.title
	desc = mem_ceaseless.165.desc
	picture = GFX_evt_alien_hieroglyphics
	location = this
	show_sound = event_bad_omen
	is_triggered_only = yes
	trigger = {
	}
	immediate = {
		system_star = {
			create_ambient_object = {
				type = mem_surveyor_ambient_object
			}
		}
	}
	option = {
		name = mem_ceaseless.165.a		# like a good dog
		owner = {
			add_monthly_resource_mult = {
				resource = unity
				value = 6
			}
		}
	}
	option = {
		name = mem_ceaseless.165.a		# imrpove battery
		owner = {
			add_monthly_resource_mult = {
				resource = engineering_research
				value = 6
			}
		}
	}
	after = {
		mem_ceaseless_open_portals = yes
	}
}

# - a pre-ftl god?
ship_event = {
	id = mem_ceaseless.160
	title = mem_ceaseless.160.title
	desc = mem_ceaseless.160.desc
	picture = GFX_evt_alien_hieroglyphics
	location = this
	show_sound = event_bad_omen
	is_triggered_only = yes
	trigger = {
	}
	immediate = {
		owner = {
			set_country_flag = mem_ceaseless_preftl
		}
	}
	option = {
		name = mem_ceaseless.160.a		# fascinating
		owner = {
			add_modifier = {
				modifier = mem_ceaseless_preftl_god
			}
		}
	}
	after = {
		mem_ceaseless_open_portals = yes
	}
}

# - now a trap / beacon /  lure
ship_event = {
	id = mem_ceaseless.155
	title = mem_ceaseless.155.title
	desc = mem_ceaseless.155.desc
	picture = GFX_evt_pirates_attacking_cargo
	location = this
	show_sound = event_bad_omen
	is_triggered_only = yes
	trigger = {
	}
	immediate = {
		# TODO hostiles
	}
	option = {
		name = mem_ceaseless.155.a		# evasive manourvers
	}
	after = {
		mem_ceaseless_open_portals = yes
	}
}

# - repurposed to relic, still runnning core
ship_event = {
	id = mem_ceaseless.150
	title = mem_ceaseless.150.title
	desc = mem_ceaseless.150.desc
	picture = GFX_evt_the_last_stormshelter
	location = this
	show_sound = event_bad_omen
	is_triggered_only = yes
	trigger = {
	}
	immediate = {
		owner = {
			set_country_flag = mem_ceaseless_relic
		}
	}
	# option = {
	# 	name = mem_ceaseless.150.a		# r_mem_surveyor_mobile_production_matrix
	# 	owner = {
	# 		add_relic = r_mem_surveyor_mobile_production_matrix
	# 	}
	# }
	option = {
		name = mem_ceaseless.150.b		# r_mem_surveyor_personality_core
		owner = {
			add_relic = r_mem_surveyor_personality_core
		}
	}
	after = {
		mem_ceaseless_open_portals = yes
	}
}

# - concious explorer leave behind missions and explores on its own?
ship_event = {
	id = mem_ceaseless.145
	title = mem_ceaseless.145.title
	desc = mem_ceaseless.145.desc
	picture = GFX_evt_ship_travel
	location = this
	show_sound = event_bad_omen
	is_triggered_only = yes
	trigger = {
	}
	immediate = {
	}
	option = {
		name = mem_ceaseless.145.a		# it left us somthing
		hidden_effect = {
			solar_system = {
				every_system_planet = {
					set_surveyed = {
						surveyed = yes
						surveyor = root.owner
					}
				}
			}
		}
	}
	after = {
		mem_ceaseless_open_portals = yes
	}
}

# - berserker got destroyed
ship_event = {
	id = mem_ceaseless.140
	title = mem_ceaseless.140.title
	desc = mem_ceaseless.140.desc
	picture = GFX_evt_astral_rift_advisor_evil
	location = this
	show_sound = event_bad_omen
	is_triggered_only = yes
	trigger = {
	}
	immediate = {
		owner = {
			set_country_flag = mem_ceaseless_berserker
		}
	}
	option = {
		name = mem_ceaseless.140.a		# we might need that knowledge
		owner = {
			add_modifier = {
				modifier = mem_surveyor_how_to_kill
			}
		}
	}
	option = {
		name = mem_ceaseless.140.b		# gimme tech
		owner = {
			scion_engineering_tech = yes
		}
	}
	after = {
		mem_ceaseless_open_portals = yes
	}
}

# - got shredded by particles
ship_event = {
	id = mem_ceaseless.135
	title = mem_ceaseless.135.title
	desc = mem_ceaseless.135.desc
	picture = GFX_evt_astral_rift_ancient_battlegrounds
	location = this
	show_sound = event_bad_omen
	is_triggered_only = yes
	trigger = {
	}
	immediate = {
	}
	option = {
		name = mem_ceaseless.135.a		# regretable
		owner = {
			add_resource = {
				alloys = 10
			}
		}
	}
	after = {
		mem_ceaseless_open_portals = yes
	}
}

# - crashed into planet
ship_event = {
	id = mem_ceaseless.130
	title = mem_ceaseless.130.title
	desc = mem_ceaseless.130.desc
	picture = GFX_evt_storm_formation
	location = this
	show_sound = event_bad_omen
	is_triggered_only = yes
	trigger = {
	}
	immediate = {
	}
	option = {
		name = mem_ceaseless.130.a		# regretable
	}
	after = {
		mem_ceaseless_open_portals = yes
	}
}

# - ship from theseus probe - all replaced but still the same?
ship_event = {
	id = mem_ceaseless.125
	title = mem_ceaseless.125.title
	desc = mem_ceaseless.125.desc
	picture = GFX_evt_space_debris
	location = this
	show_sound = event_bad_omen
	is_triggered_only = yes
	trigger = {
	}
	immediate = {
		system_star = {
			create_ambient_object = {
				type = mem_surveyor_ambient_object
			}
		}
		owner = {
			set_country_flag = mem_ceaseless_theseus
		}
	}
	option = {
		name = mem_ceaseless.125.a		# its the same probe
	}
	option = {
		name = mem_ceaseless.120.b		# its not ours anymore
	}
	after = {
		owner = {
			give_technology = {
				tech = tech_modular_engineering
			}
			add_monthly_resource_mult = {
				resource = unity
				value = 3
			}
		}
		mem_ceaseless_open_portals = yes
	}
}

# - worm reference - " what was will be"
# worm cultist started looping
ship_event = {
	id = mem_ceaseless.120
	title = mem_ceaseless.120.title
	desc = mem_ceaseless.120.desc
	picture = GFX_evt_conclave
	location = this
	show_sound = event_bad_omen
	is_triggered_only = yes
	trigger = {
	}
	immediate = {
		solar_system = {
			random_system_planet = {
				limit = {
					can_have_mineral_deposits = yes
					habitable_planet = no
				}
				save_event_target_as = mem_ceaseless_wormy
			}
		}
		owner = {
			set_country_flag = mem_ceaseless_wormy
		}
	}
	option = {
		name = mem_ceaseless.120.a		# lies!
		owner = {
			add_monthly_resource_mult = {
				resource = unity
				value = 3
			}
		}
	}
	option = {
		name = mem_ceaseless.120.b		# how?
		owner = {
			add_monthly_resource_mult = {
				resource = society_research
				value = 3
			}
		}
	}
	after = {
		if = {
			limit = {
				exists = event_target:mem_ceaseless_wormy
			}
			event_target:mem_ceaseless_wormy = {
				change_pc = pc_nuked
				set_planet_size = 12
				add_building = building_akx_worm_3
			}
		}
		mem_ceaseless_open_portals = yes
	}
}

# - merged with something metallic
ship_event = {
	id = mem_ceaseless.115
	title = mem_ceaseless.115.title
	desc = mem_ceaseless.115.desc
	picture = GFX_evt_shrouded_planet
	show_sound = event_bad_omen
	is_triggered_only = yes
	location = this
	trigger = {
	}
	immediate = {
		solar_system = {
			random_system_planet = {
				save_event_target_as = mem_ceaseless_wormy
			}
		}
	}
	option = {
		name = mem_ceaseless.115.a		# cscrap it
		owner = {
			add_resource = {
				alloys = 1000
				minerals = 2000
			}
		}
	}
	option = {
		name = mem_ceaseless.115.b		# research it
		event_target:mem_ceaseless_wormy = {
			add_deposit = d_engineering_10
		}
	}
	after = {
		mem_ceaseless_open_portals = yes
	}
}

# - intact but not active - warning inscribe: "dont do this again"
ship_event = {
	id = mem_ceaseless.110
	title = mem_ceaseless.110.title
	desc = mem_ceaseless.110.desc
	picture = GFX_evt_ship_in_orbit_2
	show_sound = event_bad_omen
	is_triggered_only = yes
	location = this
	trigger = {
	}
	immediate = {
		solar_system = {
			random_system_planet = {
				create_ambient_object = {
					type = mem_surveyor_ambient_object
				}
			}
		}
	}
	option = {
		name = mem_ceaseless.110.a		# scary xenos
		owner = {
			add_modifier = {
				modifier = promoted_xenophobe
				days = 720
			}
		}
	}
	option = {
		name = mem_ceaseless.110.b		# no worries
		allow = {
			owner = {
				resource_stockpile_compare = {
					resource = influence
					value = 100
				}
			}
		}
		owner = {
			add_resource = {
				influence = -100
			}
		}
	}
	after = {
		mem_ceaseless_open_portals = yes
	}
}

# - recycle one - got scrapped by something enourmous -scrapper bot system if exists
ship_event = {
	id = mem_ceaseless.105
	title = mem_ceaseless.105.title
	desc = mem_ceaseless.105.desc
	picture = GFX_evt_scavenger_bot
	show_sound = event_bad_omen
	is_triggered_only = yes
	location = this
	trigger = {
	}
	immediate = {
		owner = {
			set_country_flag = mem_ceaseless_scavenger
		}
	}
	option = {
		name = mem_ceaseless.105.a
		trigger = {
			any_system = {
				has_star_flag = scavenger_bot_system
			}
		}
		random_system = {
			limit = {
				has_star_flag = scavenger_bot_system
			}
			set_surveyed = {
				surveyed = yes
				surveyor = root.owner
			}
		}
		owner = {
			add_modifier = {
				modifier = scavenger_weak_points
				mult = 1.5
			}
		}
	}
	option = {
		name = mem_ceaseless.105.b
		system_star = {
			add_deposit = d_alloys_4
		}
	}
	after = {
		mem_ceaseless_open_portals = yes
	}
}

# - curious probe following a signal leading to unkown ?
ship_event = {
	id = mem_ceaseless.100
	title = mem_ceaseless.100.title
	desc = mem_ceaseless.100.desc
	picture = GFX_evt_communication_event
	show_sound = event_bad_omen
	is_triggered_only = yes
	location = this
	trigger = {
	}
	immediate = {
	}
	option = {
		name = mem_ceaseless.100.a
		owner = {
			add_monthly_resource_mult = {
				resource = unity
				value = 2
			}
		}
	}
	after = {
		mem_ceaseless_open_portals = yes
	}
}
